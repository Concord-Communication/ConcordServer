(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{395:function(t,s,e){"use strict";e.r(s);var a=e(54),n=Object(a.a)({},(function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"concord-websocket-api"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#concord-websocket-api"}},[t._v("#")]),t._v(" Concord Websocket API")]),t._v(" "),e("p",[t._v("The Concord web server relies on websockets to send real-time updates to clients regarding chat messages, user activity, and any other changes to the state of the server. This documentation defines the types of messages which can sent and received by a client that's connected to the server.")]),t._v(" "),e("p",[t._v("All messages follow a simple structure that's defined by the "),e("code",[t._v("type")]),t._v(" attribute of the message; this should be present in any message the server sends or receives. The value of "),e("code",[t._v("type")]),t._v(" indicates what message has been sent, and consequently, what structure it will have.")]),t._v(" "),e("h2",{attrs:{id:"connecting"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#connecting"}},[t._v("#")]),t._v(" Connecting")]),t._v(" "),e("p",[t._v("To connect to a Concord server's websocket endpoint, follow these steps:")]),t._v(" "),e("ol",[e("li",[t._v("Obtain a valid access token from the server's "),e("RouterLink",{attrs:{to:"/rest-api/"}},[e("code",[t._v("/api/tokens")])]),t._v(" endpoint.")],1),t._v(" "),e("li",[t._v("Open a new websocket connection to a URL formatted like "),e("code",[t._v("wss://<server-url>/client?token=<access-token>")]),t._v(", where "),e("code",[t._v("<server-url>")]),t._v(" is replaced with your desired Concord server's URL, and "),e("code",[t._v("<access-token>")]),t._v(" is replaced with your access token.")])]),t._v(" "),e("blockquote",[e("p",[t._v("Note that while most Concord servers should be accessible via HTTPS/WSS, it is not required. If the Concord server you're trying to connect to does not use a secure connection, you must start your websocket URL with "),e("code",[t._v("ws://")]),t._v(" instead of "),e("code",[t._v("wss://")]),t._v(".")])]),t._v(" "),e("p",[t._v("Here's a barebones Javascript example that connects to a Concord server running on "),e("code",[t._v("localhost:8080")]),t._v(", and simply logs all received messages to the console:")]),t._v(" "),e("div",{staticClass:"language-javascript extra-class"},[e("pre",{pre:!0,attrs:{class:"language-javascript"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" token "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"YOUR-TOKEN-HERE"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" ws "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("WebSocket")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ws://localhost:8080/client?token="')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" token"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nws"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("onopen")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Opened websocket connection."')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nws"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("onmessage")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("msg")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("msg"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nws"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("onclose")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Closed."')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("h2",{attrs:{id:"standard-practices"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#standard-practices"}},[t._v("#")]),t._v(" Standard Practices")]),t._v(" "),e("p",[t._v("When sending and receiving messages, the Concord server will make some common assumptions about the data that's being transferred.")]),t._v(" "),e("h3",{attrs:{id:"format"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#format"}},[t._v("#")]),t._v(" Format")]),t._v(" "),e("p",[t._v("All messages are sent by the server in JSON format, using UTF-8 character encoding. It is assumed that all messages sent by clients will also be in JSON format, using the UTF-8 encoding. Messages sent by clients which do not follow this format may receive an error response, or they may be ignored by the server.")]),t._v(" "),e("h3",{attrs:{id:"timestamps"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#timestamps"}},[t._v("#")]),t._v(" Timestamps")]),t._v(" "),e("p",[t._v("Unless otherwise denoted for a particular message type, "),e("strong",[t._v("all timestamps are in milliseconds since the Unix epoch")]),t._v(". You can usually find timestamps by their "),e("code",[t._v("...At")]),t._v(" suffix, like with "),e("code",[t._v("sentAt")]),t._v(", "),e("code",[t._v("createdAt")]),t._v(", "),e("code",[t._v("updatedAt")]),t._v(", etc. No time zone information is provided.")]),t._v(" "),e("h3",{attrs:{id:"nullable-attributes"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#nullable-attributes"}},[t._v("#")]),t._v(" Nullable Attributes")]),t._v(" "),e("p",[t._v("Unless otherwise denoted, "),e("strong",[t._v("all attributes are assumed to be non-null")]),t._v(". This applies to both messages sent by the server, and those sent by clients. You may assume that providing a null value where it is not explicitly denoted as being allowed may result in an error response, or the server may choose to ignore the message.")])])}),[],!1,null,null,null);s.default=n.exports}}]);